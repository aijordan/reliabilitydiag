<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Reliability diagram object — reliabilitydiag • reliabilitydiag</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Reliability diagram object — reliabilitydiag" />
<meta property="og:description" content="Documentation of the 'reliabilitydiag' object, and its constructors." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">reliabilitydiag</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/aijordan/reliabilitydiag/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reliability diagram object</h1>
    <small class="dont-index">Source: <a href='https://github.com/aijordan/reliabilitydiag/blob/master/R/reliabilitydiag.R'><code>R/reliabilitydiag.R</code></a></small>
    <div class="hidden name"><code>reliabilitydiag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Documentation of the <code>'reliabilitydiag'</code> object, and its constructors.</p>
    </div>

    <pre class="usage"><span class='fu'>reliabilitydiag</span>(
  <span class='no'>...</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>.Machine</span>$<span class='no'>double.eps</span>),
  <span class='kw'>xtype</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>xvalues</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>region.level</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
  <span class='kw'>region.method</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>region.position</span> <span class='kw'>=</span> <span class='st'>"diagonal"</span>,
  <span class='kw'>n.boot</span> <span class='kw'>=</span> <span class='fl'>100</span>
)

<span class='fu'>reliabilitydiag0</span>(<span class='no'>y</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>objects to be coerced to <code>'reliabilitydiag'</code> and concatenated</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a numeric vector of binary response values in {0, 1} to be
predicted.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>an object inheriting from the class <code>'reliabilitydiag'</code>;
alternative to <code>y</code>.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>accuracy when comparing <code>y</code> in <code>'reliabilitydiag'</code>
objects.</p></td>
    </tr>
    <tr>
      <th>xtype</th>
      <td><p>a string specifying whether the prediction values should be
treated as <code>"continuous"</code> or <code>"discrete"</code>.</p></td>
    </tr>
    <tr>
      <th>xvalues</th>
      <td><p>a numeric vector of possible prediction values;
values in <code>x</code> are rounded to the nearest value in <code>xvalues</code> and
<code>xtype</code> is set to <code>"discrete"</code>.</p></td>
    </tr>
    <tr>
      <th>region.level</th>
      <td><p>a value in (0, 1) specifying the level at which
consistency or confidence regions are calculated.</p></td>
    </tr>
    <tr>
      <th>region.method</th>
      <td><p>a string specifying whether <code>"resampling"</code>,
<code>"continuous_asymptotics"</code>, or <code>"discrete_asymptotics"</code> are used
to calculate consistency/confidence regions.</p></td>
    </tr>
    <tr>
      <th>region.position</th>
      <td><p>a string specifying whether consistency regions
around the <code>"diagonal"</code> or confidence regions around the
<code>"estimate"</code> are calculated.</p></td>
    </tr>
    <tr>
      <th>n.boot</th>
      <td><p>the number of bootstrap samples when
<code>region.method == "resampling"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>reliabilitydiag</code> returns a <code>'reliabilitydiag'</code> object,
 which is a named list-type vector class with the attribute
 <code>y</code> containing the values supplied to the input argument <code>y</code>,
 that is, the numeric vector of response values to be predicted.
 The length is given by the number of prediction methods detected from the
 supplied objects.</p>
<p><code>reliabilitydiag0</code> returns an empty <code>'reliabilitydiag'</code> object
 with attribute <code>y</code>.</p>
<p>Each entry of a <code>'reliabilitydiag'</code> object
 (corresponding to a single prediction method)
 is itself a list with the following entries</p><table class='table'>
<tr><td><code>cases</code></td><td>a tibble of all predictions and observations.</td></tr>
<tr><td><code>bins</code></td><td>a tibble of the characteristics of the PAV induced bins.</td></tr>
<tr><td><code>regions</code></td><td>a tibble with lower and upper bounds of the pointwise
     consistency/confidence regions.</td></tr>
<tr><td><code>xinfo</code></td><td>a list of characteristics of <code>x</code>.</td></tr>
</table>


<p>Each <code>cases</code> tibble comprises the forecast-observation pairs of the
 given prediction method. It is arranged in increasing order of
 <code>x</code> and has columns</p><table class='table'>
<tr><td><code>case_id</code></td><td>an ID based on the original order of the predictions
     and observations.</td></tr>
<tr><td><code>x</code></td><td>an original prediction (increasing order).</td></tr>
<tr><td><code>y</code></td><td>an observation, corresponding to <code>x</code>.</td></tr>
<tr><td><code>bin_id</code></td><td>an ID for the PAV-recalibration induced bins.</td></tr>
<tr><td><code>CEP_pav</code></td><td>the unique PAV-recalibrated prediction
     corresponding to <code>bin_id</code>.</td></tr>
</table>


<p>Each <code>bins</code> tibble contains PAV-recalibration information, and has
 columns</p><table class='table'>
<tr><td><code>bin_id</code></td><td>as in <code>cases</code>, with any ID only appearing
     once.</td></tr>
<tr><td><code>n</code></td><td>the number of predictions with a given <code>bin_id</code>.</td></tr>
<tr><td><code>x_min</code></td><td>the smallest value of the predictions with the given
     <code>bin_id</code>.</td></tr>
<tr><td><code>x_max</code></td><td>the largest value of the predictions with the given
     <code>bin_id</code>.</td></tr>
<tr><td><code>CEP_pav</code></td><td>the unique PAV-recalibrated prediction
     corresponding to <code>bin_id</code>.</td></tr>
</table>


<p>Each <code>regions</code> tibble contains the uncertainty quantification
 information, and has columns</p><table class='table'>
<tr><td><code>x</code></td><td>an original prediction, with any value only appearing
     once.</td></tr>
<tr><td><code>lower</code></td><td>the lower bound of the consistency/confidence
     region at <code>x</code>.</td></tr>
<tr><td><code>upper</code></td><td>the upper bound of the consistency/confidence
     region <code>x</code>.</td></tr>
<tr><td><code>n</code></td><td>the number of predictions with a value of <code>x</code>.</td></tr>
<tr><td><code>level</code></td><td>the level of the consistency/confidence regions.</td></tr>
<tr><td><code>method</code></td><td>the method used to calculate the
     consistency/confidence region.</td></tr>
<tr><td><code>position</code></td><td><code>"diagonal"</code> for a consistency region, and
     <code>"estimate"</code> for a confidence region.</td></tr>
</table>


<p>Each <code>xinfo</code> list has entries</p><table class='table'>
<tr><td><code>type</code></td><td>the type of predictions, either <code>"discrete"</code>
       or <code>"continuous"</code>.</td></tr>
<tr><td><code>values</code></td><td>the values supplied to <code>xvalues</code>.</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>reliabilitydiag</code> constructs and returns an object inheriting from the
class <code>'reliabilitydiag'</code>.
Each object passed via <code>...</code> is
coerced by the methods described in <code><a href='as.reliabilitydiag.html'>as.reliabilitydiag</a></code>,
and then concatenated by <code><a href='c.reliabilitydiag.html'>c.reliabilitydiag</a></code>.</p>
<p><code>reliabilitydiag0</code> constructs an empty <code>'reliabilitydiag'</code> object
from the response values.</p>
<p>If any of the arguments <code>region.level</code>, <code>region.method</code>,
or <code>region.position</code> is <code>NA</code>, then the uncertainty quantification
in terms of consistency/confidence regions is skipped.</p>
<p>Consistency regions are determined under the assumption of calibration of
the original predictions, that is, perfectly reliable forecasts such that
\(P(Y = 1|X) = X\).
Consistency regions are therefore positioned around values on the diagonal
(set <code>region.position</code> to <code>"diagonal"</code>).</p>
<p>For confidence regions, calibration is enforced by using the PAV-recalibrated
predictions for uncertainty quantification, that is, it is assumed that
\(P(Y = 1|X) = PAV(X)\).
Confidence regions are therefore positioned around the estimated
conditional exceedence probability (CEP) line
(set <code>region.position</code> to <code>"estimate"</code>).</p>
<p>When <code>region.method</code> is <code>"resampling"</code>, then the original
forecast-observations pairs are bootstrapped <code>n.boot</code> times.
For each bootstrap sample, new observations are drawn under the respective
assumption (consistency or confidence).
Then PAV-recalibration with those new observations is performed on each
bootstrap sample, and pointwise
lower and upper bounds are calculated across the resulting CEP lines.</p>
<p>When <code>region.method</code> is <code>"discrete_asymptotics"</code> and
<code>region.position</code> is <code>"diagonal"</code>,
a Gaussian
approximation is used assuming \(\sqrt{n} * (EST(x0) - x0)\) has variance
\(x0(1-x0)\), where
\(x0\) is an original prediction value,
\(n\) is the observed number of predictions with value \(x0\),
and \(EST(x0)\) is the estimated CEP value at \(x0\).</p>
<p>When <code>region.method</code> is <code>"continuous_asymptotics"</code> and
<code>region.position</code> is <code>"diagonal"</code>,
a Chernoff approximation is used for
\((n * f(x0) / (4 * x0 * (1- x0)))^(1/3) * (EST(x0) - x0)\),
where \(x0\) is an original prediction value,
\(n\) is the total number of observations,
\(EST(x0)\) is the estimated CEP value at \(x0\),
and \(f(x0)\) is the estimated value of the density of the
original prediction values.
This density is estimated using the <code>bde</code> package: We use Chen's
beta kernel density estimator (see <code><a href='https://rdrr.io/pkg/bde/man/bde.html'>bde::bde()</a></code>).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='c.reliabilitydiag.html'>c.reliabilitydiag</a></code>,
 <code><a href='sub-.reliabilitydiag.html'>[.reliabilitydiag</a></code>,
 <code><a href='plot.reliabilitydiag.html'>plot.reliabilitydiag</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>42</span>)

<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>)
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='fl'>100</span>, <span class='fl'>1</span>, <span class='no'>X</span>)
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='fu'>reliabilitydiag</span>(<span class='no'>X</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Y</span>)</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* `` -&gt; ...1</span></div><div class='input'><span class='no'>r</span></div><div class='img'><img src='reliabilitydiag-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 'brier' score decomposition (see also ?summary.reliabilitydiag)
#&gt; <span style='color: #555555;'># A tibble: 1 x 5</span><span>
#&gt;   forecast mean_score miscalibration discrimination uncertainty
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>       </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> ...1          0.153         0.024</span><span style='text-decoration: underline;'>2</span><span>          0.120       0.249</div><div class='input'>
<span class='co'># no consistency/confidence regions</span>
<span class='no'>r1</span> <span class='kw'>&lt;-</span> <span class='fu'>reliabilitydiag</span>(<span class='no'>X</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Y</span>, <span class='kw'>region.level</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* `` -&gt; ...1</span></div><div class='input'><span class='no'>r1</span></div><div class='img'><img src='reliabilitydiag-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 'brier' score decomposition (see also ?summary.reliabilitydiag)
#&gt; </span><span style='color: #555555;'># A tibble: 1 x 5</span><span>
#&gt;   forecast mean_score miscalibration discrimination uncertainty
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>          </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>       </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> ...1          0.153         0.024</span><span style='text-decoration: underline;'>2</span><span>          0.120       0.249</div><div class='input'>
<span class='co'># specify predictions via existing reliabilitydiag</span>
<span class='no'>r0</span> <span class='kw'>&lt;-</span> <span class='fu'>reliabilitydiag0</span>(<span class='no'>Y</span>)
<span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span>(<span class='no'>r1</span>, <span class='fu'>reliabilitydiag</span>(<span class='no'>X</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='no'>r0</span>, <span class='kw'>region.level</span> <span class='kw'>=</span> <span class='fl'>NA</span>))</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* `` -&gt; ...1</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># only observation information is used from existing reliabilitydiag</span>
<span class='no'>X2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>)
<span class='no'>r2</span> <span class='kw'>&lt;-</span> <span class='fu'>reliabilitydiag</span>(<span class='no'>X2</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='no'>r</span>, <span class='kw'>region.level</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* `` -&gt; ...1</span></div><div class='input'><span class='no'>r3</span> <span class='kw'>&lt;-</span> <span class='fu'>reliabilitydiag</span>(<span class='no'>X2</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='no'>r0</span>, <span class='kw'>region.level</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</div><div class='output co'>#&gt; <span class='message'>New names:</span>
#&gt; <span class='message'>* `` -&gt; ...1</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span>(<span class='no'>r2</span>, <span class='no'>r3</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Timo Dimitriadis, Alexander I. Jordan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


